
pub mod ffi;
pub mod safe;

pub mod mem_helpers;

mod conversion;

pub use conversion::FfiConversionError;

// Plugin implementation functions
extern "C" {

    /// Implement this function (and impl_serialize_resp) to have your plugin
    /// register as having a Listener module
    /// 
    /// Deserializes request recieved on associated UDP socket into a DNS protocol
    /// message with queries to be resolved
    pub fn impl_deserialize_req(req: *const u8, size: usize, message: *mut ffi::DnsMessage) -> u8;

    /// Implement this function (and impl_deserialize_req) to have your plugin
    /// register as having a Listener module
    /// 
    /// Serializes responses generated by the resolver into a response to send
    /// back to the requester over the original UDP socket
    pub fn impl_serialize_resp(resp: ffi::DnsMessage, buf: ffi::ByteVector) -> ffi::ByteVector;

    /// Implement this function for your plugin to register as having a Resolver module.
    /// 
    /// Resolves a request generated by the Listener into a response message, likely
    /// by querying (an) upstream resolver(s)
    pub fn impl_resolve_req(req: ffi::DnsMessage, resp: *mut ffi::DnsMessage) -> u8;
}